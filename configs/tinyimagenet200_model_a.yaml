model:
  type: model_a
  num_classes: 200
  in_ch: 3
  stem_dim: 64
  dpr_max: 0.11
  stages:
    - dim: 64
      depth: 2
      num_heads: 2
      grid_size: 8
      outlook_heads: 2
    - dim: 128
      depth: 3
      num_heads: 4
      grid_size: 8
      outlook_heads: 4
    - dim: 256
      depth: 4
      num_heads: 8
      grid_size: 4
      outlook_heads: 8
    - dim: 384
      depth: 2
      num_heads: 6
      grid_size: 2
      outlook_heads: 6

training:
  epochs: 50
  lr: 0.0005
  weight_decay: 0.05
  autocast_dtype: fp16
  use_amp: true
  grad_clip_norm: 1.0
  warmup_ratio: 0.05
  min_lr: 0.000001
  label_smoothing: 0.0
  print_every: 300
  save_path: best_tinyimagenet200_model_a.pt
  last_path: last_tinyimagenet200_model_a.pt
  resume_path: null
  mixup_alpha: 0.0
  cutmix_alpha: 1.0
  mix_prob: 0.5
  channels_last: true
  early_stop: true
  early_stop_metric: top1
  early_stop_patience: 10
  early_stop_min_delta: 0.0
  early_stop_require_monotonic: false

data:
  dataset: tinyimagenet200
  hf_name: zh-plus/tiny-imagenet
  data_dir: ./data
  batch_size: 64
  num_workers: 2
  val_split: 0.1
  seed: 7
  pin_memory: true
  ra_num_ops: 2
  ra_magnitude: 7
  random_erasing_p: 0.25
  img_size: 64
  drop_last: true

runtime:
  device: cuda
  seed: 7
  output_dir: outputs
